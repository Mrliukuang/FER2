[W, loss_history] = train(W, X, y_train, opts);